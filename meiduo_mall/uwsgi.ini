[uwsgi]
# 项目工作目录
chdir = /var/www/html/meiduo_mall

# Django 启动入口 (WSGI 模块路径)
module = meiduo_mall.wsgi:application

# 主进程 & 子进程数量
master = true
processes = 4

# 通信方式：通过 socket 与 nginx 交互
http = 0.0.0.0:8000
chmod-socket = 666

# 当 uwsgi 停止时自动清理 socket 文件
vacuum = true

# 每个 worker 处理多少请求后自动重启（防止内存泄漏）
max-requests = 5000

# 开启多线程
threads = 2
enable-threads = true
lazy-apps = true
preload = true

# 请求超时保护
harakiri = 60
harakiri-verbose = true

# 缓冲区大小
buffer-size = 65536

# 日志输出到控制台（方便 Docker 收集日志）
logto = /dev/stdout

# uWSGI 的日志
disable-logging = false
logto = /dev/stdout

# 让 Django 后端能正确提供 admin 的静态文件
static-map = /static=/var/www/html/static
