{"remainingRequest":"/Users/lijiahao/git-test/meiduo/meiduo_mall_frontend/node_modules/thread-loader/dist/cjs.js!/Users/lijiahao/git-test/meiduo/meiduo_mall_frontend/node_modules/babel-loader/lib/index.js!/Users/lijiahao/git-test/meiduo/meiduo_mall_frontend/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/lijiahao/git-test/meiduo/meiduo_mall_frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lijiahao/git-test/meiduo/meiduo_mall_frontend/src/components/Orders.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/lijiahao/git-test/meiduo/meiduo_mall_frontend/src/components/Orders.vue","mtime":1762018358296},{"path":"/Users/lijiahao/git-test/meiduo/meiduo_mall_frontend/babel.config.js","mtime":1762018358253},{"path":"/Users/lijiahao/git-test/meiduo/meiduo_mall_frontend/node_modules/cache-loader/dist/cjs.js","mtime":1762102178152},{"path":"/Users/lijiahao/git-test/meiduo/meiduo_mall_frontend/node_modules/thread-loader/dist/cjs.js","mtime":1762102178152},{"path":"/Users/lijiahao/git-test/meiduo/meiduo_mall_frontend/node_modules/babel-loader/lib/index.js","mtime":1762102182065},{"path":"/Users/lijiahao/git-test/meiduo/meiduo_mall_frontend/node_modules/cache-loader/dist/cjs.js","mtime":1762102178152},{"path":"/Users/lijiahao/git-test/meiduo/meiduo_mall_frontend/node_modules/vue-loader/lib/index.js","mtime":1762102181323}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7Ci8qIGVzbGludC1kaXNhYmxlICovCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiT3JkZXJzIiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgLy8g6K6i5Y2VCiAgICAgIG9yZGVyczogW10sCiAgICAgIC8vIOWIhumhteWPiuaOkuW6jwogICAgICBwYWdlOiAxLAogICAgICBwYWdlX3NpemU6IDEwLAogICAgICB0b3RhbF9wYWdlOiAwLAogICAgICAvLyDliqDovb3ov4fmuKHnirbmgIEKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIC8vIOmYsuatoui/h+a4oeWKoOi9veWPmOmHjwogICAgICBsb2FkOiB0cnVlLAogICAgICAvLyDorqLljZXlj7cKICAgICAgb3JkZXJfaWQ6ICIiCiAgICB9OwogIH0sCiAgbW91bnRlZCgpIHsKICAgIGlmICh0aGlzLiRyb3V0ZS5wYXJhbXMuaWQpIHsKICAgICAgLy8g5Yik5pat5LiA5LiL5YaN6LWL5YC877yM6Ziy5q2i6KKr6LWLdW5kZWZpbmVkCiAgICAgIHRoaXMub3JkZXJfaWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQ7CiAgICB9CiAgICB0aGlzLnF1ZXJ5X29yZGVyKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyDojrflj5borqLljZXliJfooagKICAgIGdldF9vcmRlcnMoKSB7CiAgICAgIHRoaXMuJGFwaS5vcmRlcnMoewogICAgICAgIHBhZ2U6IHRoaXMucGFnZSwKICAgICAgICBwYWdlX3NpemU6IHRoaXMucGFnZV9zaXplCiAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLm9yZGVycyA9IHJlcy5kYXRhLnJlc3VsdHM7CiAgICAgICAgLy8gICDlkJHkuIrlj5bmlbTmi7/liLDmgLvpobXmlbAKICAgICAgICB0aGlzLnRvdGFsX3BhZ2UgPSBNYXRoLmNlaWwocmVzLmRhdGEuY291bnQgLyB0aGlzLnBhZ2Vfc2l6ZSk7CgogICAgICAgIC8vIHNjcm9sbEhlaWdodDog5YWD57Sg55qE6auY5bqm5Y2z6KGo5qC85YaF5a6555qE6auY5bqmCiAgICAgICAgLy8gc2Nyb2xsVG9wOiDlhYPntKDmu5rliqjlh7rljrvnmoTpq5jluqYKICAgICAgICAvLyBjbGllbnRIZWlnaHQ6IOWFg+e0oOWPr+inhuWMuuWfn+eahOmrmOW6pgogICAgICAgIC8vIOW9k3Njcm9sbFRvcCArIGNsaWVudEhlaWdodCA9IHNjcm9sbEhlaWdodCDml7Ys5rua5Yqo5p2h5rua5Yqo5Yiw5bqV6YOoCiAgICAgICAgLy8g55uR5ZCs6KGo5qC8ZG9t5a+56LGh55qE5rua5Yqo5LqL5Lu2CiAgICAgICAgLy8gICBsZXQgZG9tID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmVsLXRhYmxlX19ib2R5Jyk7CiAgICAgICAgbGV0IGRvbSA9IHRoaXMuJHJlZnMudGFibGUuYm9keVdyYXBwZXI7CiAgICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICAgIGRvbS5hZGRFdmVudExpc3RlbmVyKCJzY3JvbGwiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBjb25zdCBzY3JvbGxEaXN0YW5jZSA9IGRvbS5zY3JvbGxIZWlnaHQgLSBkb20uc2Nyb2xsVG9wIC0gZG9tLmNsaWVudEhlaWdodDsKICAgICAgICAgIC8vIOWinuWKoOS4gOS4quWIpOaWreadoeS7tu+8jOmBv+WFjeafpeivouWNleadoeaXtuinpuWPkQogICAgICAgICAgaWYgKHNjcm9sbERpc3RhbmNlIDw9IDAgJiYgdGhhdC5sb2FkKSB7CiAgICAgICAgICAgIC8v562J5LqOMOivgeaYjuW3sue7j+WIsOW6le+8jOWPr+S7peivt+axguaOpeWPowogICAgICAgICAgICBpZiAodGhhdC5wYWdlIDwgdGhhdC50b3RhbF9wYWdlKSB7CiAgICAgICAgICAgICAgLy/lvZPliY3pobXmlbDlsI/kuo7mgLvpobXmlbDlsLHor7fmsYIKICAgICAgICAgICAgICB0aGF0LnBhZ2UrKzsgLy/lvZPliY3pobXmlbDoh6rlop4KICAgICAgICAgICAgICB0aGF0LmxvYWRpbmcgPSB0cnVlOyAvLyDlsZXnpLrliqDovb3kuK3ov4fmuKHnirbmgIEKICAgICAgICAgICAgICB0aGF0LmxvYWQgPSBmYWxzZTsKICAgICAgICAgICAgICAvL+ivt+axguaOpeWPo+eahOS7o+eggQogICAgICAgICAgICAgIHRoYXQuJGFwaS5vcmRlcnMoewogICAgICAgICAgICAgICAgcGFnZTogdGhhdC5wYWdlLAogICAgICAgICAgICAgICAgcGFnZV9zaXplOiB0aGF0LnBhZ2Vfc2l6ZQogICAgICAgICAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgIC8v5bCG6K+35rGC5Zue5p2l55qE5pWw5o2u5ZKM5b2T5YmN5bGV56S655qE5pWw5o2u5ZCI5bm25Zyo5LiA6LW3CiAgICAgICAgICAgICAgICB0aGF0Lm9yZGVycyA9IHRoYXQub3JkZXJzLmNvbmNhdChyZXMuZGF0YS5yZXN1bHRzKTsKICAgICAgICAgICAgICAgIHRoYXQubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgdGhhdC5sb2FkID0gdHJ1ZTsKICAgICAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgICAgICAgICB0aGF0LmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHRoYXQubG9hZCA9IHRydWU7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g5p+l6K+i5Y2V5p2h6K6i5Y2VCiAgICBnZXRfb3JkZXIob3JkZXJfaWQpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsgLy8g5bGV56S65Yqg6L295Lit6L+H5rih54q25oCBCiAgICAgIHRoaXMubG9hZCA9IGZhbHNlOwogICAgICB0aGlzLiRhcGkub3JkZXIob3JkZXJfaWQpLnRoZW4ocmVzID0+IHsKICAgICAgICAvLyDlsIbmn6Xor6LnmoTljZXmnaHmlbDmja5wdXNo5Yiw5YiX6KGoCiAgICAgICAgdGhpcy5vcmRlcnMucHVzaChyZXMuZGF0YSk7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgdGhpcy5sb2FkID0gdHJ1ZTsKICAgICAgfSkuY2F0Y2goKCkgPT4gewogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgIHRoaXMubG9hZCA9IHRydWU7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOafpeivouiuouWNlQogICAgcXVlcnlfb3JkZXIoKSB7CiAgICAgIHRoaXMub3JkZXJzID0gW107IC8vIOaQnOe0ouS5i+WJjemDveWFiOa4heepuuWIl+ihqAogICAgICB0aGlzLnBhZ2UgPSAxOyAvLyDph43nva5wYWdl5Li656ys5LiA6aG1CiAgICAgIGlmICh0aGlzLm9yZGVyX2lkKSB7CiAgICAgICAgdGhpcy5nZXRfb3JkZXIodGhpcy5vcmRlcl9pZCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5nZXRfb3JkZXJzKCk7CiAgICAgIH0KICAgIH0sCiAgICAvLyDnq4vljbPmlK/ku5gKICAgIHBheV9vcmRlcihvcmRlcl9pZCkgewogICAgICB0aGlzLiRhcGkucGF5bWVudF91cmwob3JkZXJfaWQpLnRoZW4ocmVzID0+IHsKICAgICAgICB3aW5kb3cub3BlbihyZXMuZGF0YS51cmwpOwogICAgICAgIC8vIGxvY2F0aW9uLmhyZWYgPSByZXMuZGF0YS51cmw7CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"names":["name","data","orders","page","page_size","total_page","loading","load","order_id","mounted","$route","params","id","query_order","methods","get_orders","$api","then","res","results","Math","ceil","count","dom","$refs","table","bodyWrapper","that","addEventListener","scrollDistance","scrollHeight","scrollTop","clientHeight","concat","catch","get_order","order","push","pay_order","payment_url","window","open","url"],"sources":["src/components/Orders.vue"],"sourcesContent":["<template>\n  <div>\n    <el-row>\n      <el-col :span=\"21\">\n        <el-input\n          placeholder=\"输入订单号查询订单\"\n          size=\"mini\"\n          style=\"width: 25em;\"\n          v-model=\"order_id\"\n          onkeyup=\"value = value.replace(/[^\\d]/g,'');\"\n        >\n          <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"query_order()\"></el-button>\n        </el-input>\n      </el-col>\n      <el-col :span=\"3\" style=\"color: grey;\">\n        <span v-if=\"loading\">\n          <i class=\"el-icon-loading\" slot=\"suffix\"></i>加载中...\n        </span>\n      </el-col>\n    </el-row>\n    <el-divider></el-divider>\n    <div style=\"height: 29em; width: 51em;\">\n      <el-row>\n        <el-table\n          :data=\"orders\"\n          height=\"39em\"\n          ref=\"table\"\n          size=\"mini\"\n          :header-cell-style=\"{background:'#eef1f6',color:'#606266', 'text-align': 'center'}\"\n          style=\"overflow-anchor:none;\"\n        >\n          <el-table-column type=\"expand\">\n            <template slot-scope=\"props\">\n              <el-table\n                :data=\"props.row.skus\"\n                size=\"mini\"\n                :header-cell-style=\"{background:'#eef1f6',color:'#606266', 'text-align': 'center'}\"\n              >\n                <el-table-column align=\"center\" width=\"90\">\n                  <template slot-scope=\"scope\">\n                    <el-image\n                      :src=\"scope.row.sku.default_image_url\"\n                      style=\"width: 5em; height: 5em;\"\n                    ></el-image>\n                  </template>\n                </el-table-column>\n                <el-table-column label=\"商品名称\" width=\"250\">\n                  <template slot-scope=\"scope\">{{ scope.row.sku.name }}</template>\n                </el-table-column>\n                <el-table-column align=\"center\" label=\"规格\" prop=\"spec\" width=\"120\"></el-table-column>\n                <el-table-column align=\"center\" label=\"数量\" prop=\"count\" width=\"80\"></el-table-column>\n                <el-table-column align=\"center\" label=\"价格\" prop=\"price\" width=\"100\"></el-table-column>\n                <el-table-column align=\"center\" label=\"历史评分\" prop=\"score\" width=\"80\"></el-table-column>\n              </el-table>\n            </template>\n          </el-table-column>\n          <el-table-column align=\"center\" label=\"序号\" width=\"80\" type=\"index\"></el-table-column>\n          <el-table-column align=\"center\" label=\"订单号\" prop=\"order_id\" width=\"160\"></el-table-column>\n          <el-table-column align=\"center\" label=\"数量\" prop=\"total_count\" width=\"80\"></el-table-column>\n          <el-table-column align=\"center\" label=\"总金额\" prop=\"total_amount\" width=\"120\"></el-table-column>\n          <el-table-column align=\"center\" label=\"订单运费\" prop=\"freight\" width=\"120\"></el-table-column>\n          <el-table-column align=\"center\" label=\"订单状态\" prop=\"status_text\" width=\"85\"></el-table-column>\n          <el-table-column align=\"center\" label=\"操作\" width=\"120\">\n            <template slot-scope=\"scope\">\n              <el-button\n                type=\"primary\"\n                size=\"mini\"\n                v-if=\"scope.row.status == 1\"\n                @click=\"pay_order(scope.row.order_id)\"\n              >去支付</el-button>\n              <el-button type=\"primary\" size=\"mini\" v-if=\"scope.row.status == 2\">去催单</el-button>\n              <el-button type=\"primary\" size=\"mini\" v-if=\"scope.row.status == 3\">确认收货</el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-row>\n    </div>\n  </div>\n</template>\n<script>\n/* eslint-disable */\nexport default {\n  name: \"Orders\",\n  data() {\n    return {\n      // 订单\n      orders: [],\n\n      // 分页及排序\n      page: 1,\n      page_size: 10,\n      total_page: 0,\n\n      // 加载过渡状态\n      loading: false,\n\n      // 防止过渡加载变量\n      load: true,\n\n      // 订单号\n      order_id: \"\"\n    };\n  },\n  mounted() {\n    if (this.$route.params.id) {\n      // 判断一下再赋值，防止被赋undefined\n      this.order_id = this.$route.params.id;\n    }\n    this.query_order();\n  },\n  methods: {\n    // 获取订单列表\n    get_orders() {\n      this.$api\n        .orders({\n          page: this.page,\n          page_size: this.page_size\n        })\n        .then(res => {\n          this.orders = res.data.results;\n          //   向上取整拿到总页数\n          this.total_page = Math.ceil(res.data.count / this.page_size);\n\n          // scrollHeight: 元素的高度即表格内容的高度\n          // scrollTop: 元素滚动出去的高度\n          // clientHeight: 元素可视区域的高度\n          // 当scrollTop + clientHeight = scrollHeight 时,滚动条滚动到底部\n          // 监听表格dom对象的滚动事件\n          //   let dom = document.querySelector('.el-table__body');\n          let dom = this.$refs.table.bodyWrapper;\n          let that = this;\n          dom.addEventListener(\"scroll\", function() {\n            const scrollDistance =\n              dom.scrollHeight - dom.scrollTop - dom.clientHeight;\n            // 增加一个判断条件，避免查询单条时触发\n            if (scrollDistance <= 0 && that.load) {\n              //等于0证明已经到底，可以请求接口\n              if (that.page < that.total_page) {\n                //当前页数小于总页数就请求\n                that.page++; //当前页数自增\n                that.loading = true; // 展示加载中过渡状态\n                that.load = false;\n                //请求接口的代码\n                that.$api\n                  .orders({\n                    page: that.page,\n                    page_size: that.page_size\n                  })\n                  .then(res => {\n                    //将请求回来的数据和当前展示的数据合并在一起\n                    that.orders = that.orders.concat(res.data.results);\n                    that.loading = false;\n                    that.load = true;\n                  })\n                  .catch(() => {\n                    that.loading = false;\n                    that.load = true;\n                  });\n              }\n            }\n          });\n        });\n    },\n\n    // 查询单条订单\n    get_order(order_id) {\n      this.loading = true; // 展示加载中过渡状态\n      this.load = false;\n      this.$api\n        .order(order_id)\n        .then(res => {\n          // 将查询的单条数据push到列表\n          this.orders.push(res.data);\n          this.loading = false;\n          this.load = true;\n        })\n        .catch(() => {\n          this.loading = false;\n          this.load = true;\n        });\n    },\n\n    // 查询订单\n    query_order() {\n      this.orders = []; // 搜索之前都先清空列表\n      this.page = 1; // 重置page为第一页\n      if (this.order_id) {\n        this.get_order(this.order_id);\n      } else {\n        this.get_orders();\n      }\n    },\n\n    // 立即支付\n    pay_order(order_id) {\n      this.$api.payment_url(order_id).then(res => {\n        window.open(res.data.url);\n        // location.href = res.data.url;\n      });\n    }\n  }\n};\n</script>\n<style scoped >\n.el-divider {\n  margin: 0.5em;\n  margin-left: 0;\n  padding: 0.1em 0;\n  background-color: tomato;\n}\ndiv /deep/.el-input__inner {\n  border: 2px solid #e23b3b;\n}\n</style>"],"mappings":";AAgFA;AACA;EACAA,IAAA;EACAC,KAAA;IACA;MACA;MACAC,MAAA;MAEA;MACAC,IAAA;MACAC,SAAA;MACAC,UAAA;MAEA;MACAC,OAAA;MAEA;MACAC,IAAA;MAEA;MACAC,QAAA;IACA;EACA;EACAC,QAAA;IACA,SAAAC,MAAA,CAAAC,MAAA,CAAAC,EAAA;MACA;MACA,KAAAJ,QAAA,QAAAE,MAAA,CAAAC,MAAA,CAAAC,EAAA;IACA;IACA,KAAAC,WAAA;EACA;EACAC,OAAA;IACA;IACAC,WAAA;MACA,KAAAC,IAAA,CACAd,MAAA;QACAC,IAAA,OAAAA,IAAA;QACAC,SAAA,OAAAA;MACA,GACAa,IAAA,CAAAC,GAAA;QACA,KAAAhB,MAAA,GAAAgB,GAAA,CAAAjB,IAAA,CAAAkB,OAAA;QACA;QACA,KAAAd,UAAA,GAAAe,IAAA,CAAAC,IAAA,CAAAH,GAAA,CAAAjB,IAAA,CAAAqB,KAAA,QAAAlB,SAAA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA,IAAAmB,GAAA,QAAAC,KAAA,CAAAC,KAAA,CAAAC,WAAA;QACA,IAAAC,IAAA;QACAJ,GAAA,CAAAK,gBAAA;UACA,MAAAC,cAAA,GACAN,GAAA,CAAAO,YAAA,GAAAP,GAAA,CAAAQ,SAAA,GAAAR,GAAA,CAAAS,YAAA;UACA;UACA,IAAAH,cAAA,SAAAF,IAAA,CAAApB,IAAA;YACA;YACA,IAAAoB,IAAA,CAAAxB,IAAA,GAAAwB,IAAA,CAAAtB,UAAA;cACA;cACAsB,IAAA,CAAAxB,IAAA;cACAwB,IAAA,CAAArB,OAAA;cACAqB,IAAA,CAAApB,IAAA;cACA;cACAoB,IAAA,CAAAX,IAAA,CACAd,MAAA;gBACAC,IAAA,EAAAwB,IAAA,CAAAxB,IAAA;gBACAC,SAAA,EAAAuB,IAAA,CAAAvB;cACA,GACAa,IAAA,CAAAC,GAAA;gBACA;gBACAS,IAAA,CAAAzB,MAAA,GAAAyB,IAAA,CAAAzB,MAAA,CAAA+B,MAAA,CAAAf,GAAA,CAAAjB,IAAA,CAAAkB,OAAA;gBACAQ,IAAA,CAAArB,OAAA;gBACAqB,IAAA,CAAApB,IAAA;cACA,GACA2B,KAAA;gBACAP,IAAA,CAAArB,OAAA;gBACAqB,IAAA,CAAApB,IAAA;cACA;YACA;UACA;QACA;MACA;IACA;IAEA;IACA4B,UAAA3B,QAAA;MACA,KAAAF,OAAA;MACA,KAAAC,IAAA;MACA,KAAAS,IAAA,CACAoB,KAAA,CAAA5B,QAAA,EACAS,IAAA,CAAAC,GAAA;QACA;QACA,KAAAhB,MAAA,CAAAmC,IAAA,CAAAnB,GAAA,CAAAjB,IAAA;QACA,KAAAK,OAAA;QACA,KAAAC,IAAA;MACA,GACA2B,KAAA;QACA,KAAA5B,OAAA;QACA,KAAAC,IAAA;MACA;IACA;IAEA;IACAM,YAAA;MACA,KAAAX,MAAA;MACA,KAAAC,IAAA;MACA,SAAAK,QAAA;QACA,KAAA2B,SAAA,MAAA3B,QAAA;MACA;QACA,KAAAO,UAAA;MACA;IACA;IAEA;IACAuB,UAAA9B,QAAA;MACA,KAAAQ,IAAA,CAAAuB,WAAA,CAAA/B,QAAA,EAAAS,IAAA,CAAAC,GAAA;QACAsB,MAAA,CAAAC,IAAA,CAAAvB,GAAA,CAAAjB,IAAA,CAAAyC,GAAA;QACA;MACA;IACA;EACA;AACA","ignoreList":[]}]}